---
import Layout from '../../layouts/Layout.astro';
import { GoogleLoginButton } from './_components/GoogleLoginButton';
import { LoginWrapper } from './_components/LoginWrapper';

// Get error from query params
const error = Astro.url.searchParams.get('error');
const errorMessages: Record<string, string> = {
  no_code: 'Authentication code was not received',
  config_error: 'Configuration error. Please contact support.',
  exchange_failed: 'Failed to complete authentication',
  unexpected_error: 'An unexpected error occurred',
};
---

<Layout title="Login - Maya Research">
  <LoginWrapper client:only="react" errorParam={error} errorMessages={errorMessages}>
    <div class="flex min-h-screen items-center justify-center bg-gray-50 px-4">
      <div class="w-full max-w-md space-y-8 text-center">
        <!-- Brand Name -->
        <h1 class="text-2xl font-semibold tracking-tight text-gray-900" style="letter-spacing: -0.02em;">
          Maya Research
        </h1>

        <!-- Error Message -->
        {error && errorMessages[error] && (
          <div class="mx-auto max-w-sm rounded-lg bg-red-50 px-4 py-3 text-sm text-red-800">
            {errorMessages[error]}
          </div>
        )}

        <!-- Sign In Button -->
        <div class="mx-auto max-w-sm pt-2">
          <GoogleLoginButton client:load />
        </div>
      </div>
    </div>
  </LoginWrapper>
</Layout>
